<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        /* For other boilerplate styles, see: /docs/general-configuration-guide/boilerplate-content-css/ */
        /*
        * For rendering images inserted using the image plugin.
        * Includes image captions using the HTML5 figure element.
        */
        figure.image {
          display: inline-block;
          border: 1px solid gray;
          margin: 0 2px 0 1px;
          background: #f5f2f0;
        }
        figure.align-left {
          float: left;
        }
        figure.align-right {
          float: right;
        }
        figure.image img {
          margin: 8px 8px 0 8px;
        }
        figure.image figcaption {
          margin: 6px 8px 6px 8px;
          text-align: center;
        }

        /*
         Alignment using classes rather than inline styles
         check out the "formats" option
        */
        img.align-left {
          float: left;
        }
        img.align-right {
          float: right;
        }

        .tox .tox-collection__item-label {
            line-height: unset !important;
        }
    </style>
    <script src='tinymce.js'></script>
    <script type="text/javascript">
    window.setWebStyleSheetLocation = function(src, _id = 'CSS') {
        const doc = document.querySelector('#htmlEditor_ifr').contentDocument;
        let ele = doc.querySelector('html > head > link#' + _id);
        if (ele) {
            ele.setAttribute('href', src);
        } else {
            ele = doc.createElement('link');
            ele.setAttribute('id', _id);
            ele.setAttribute('rel', 'stylesheet');
            ele.setAttribute('type', 'text/css');
            ele.setAttribute('href', src);
            doc.head.appendChild(ele);
        }
    };

    tinymce.init({
        selector: '#htmlEditor',
        language: 'zh_CN',
        branding: false,
        plugins: 'preview paste importcss searchreplace autolink autoresize save code visualblocks visualchars fullscreen image table charmap hr pagebreak nonbreaking anchor insertdatetime advlist lists wordcount imagetools textpattern noneditable help charmap quickbars emoticons footnotes',
        imagetools_cors_hosts: ['picsum.photos'],
        menubar: 'file edit view insert format tools table help',
        toolbar: 'save | undo redo | bold italic underline strikethrough subscript superscript | formatselect | alignleft aligncenter alignright alignjustify | outdent indent lineheight |  numlist bullist | forecolor backcolor removeformat | pagebreak | charmap emoticons | preview | blockquote anchor footnotes',
        toolbar_sticky: true,
        image_advtab: true,
        image_caption: true,
        paste_data_images: true,
        images_dataimg_filter: function (imgItm) { return false; },
        link_list: [],
        image_list: [],
        image_class_list: [],
        importcss_append: true,
        file_picker_callback: function (callback, value, meta) {},
        templates: [],
        template_cdate_format: '[Date Created (CDATE): %m/%d/%Y : %H:%M:%S]',
        template_mdate_format: '[Date Modified (MDATE): %m/%d/%Y : %H:%M:%S]',
        quickbars_selection_toolbar: 'bold italic | quicklink h2 h3 blockquote quickimage quicktable',
        noneditable_noneditable_class: 'mceNonEditable',
        toolbar_mode: 'sliding',
        contextmenu: 'link image imagetools table',
        skin: location.search.indexOf('theme-dark') !== -1 ? 'oxide-dark' : 'oxide',
        content_css: location.search.indexOf('theme-dark') !== -1 ? 'dark' : 'default',
        content_style: `
            body {
                letter-spacing: unset !important;
                margin: 0 2rem !important;
            }
            a.mce-item-anchor[id^=a-]{
                display: none
            }
            a.mce-item-anchor[data-note]{
                background:unset;
                width:auto !important;
                height:auto !important;
            }
            a.mce-item-anchor[data-note]:before{
                content:"✱";
                font-size:85%;
            }
        `,
        pagebreak_separator: '<p data-pb></p>',
        pagebreak_split_block: true,
        fontsize_formats: '0.8rem 0.9rem 1.0rem 1.1rem 1.2rem 1.3rem 1.4rem 1.5rem 1.6rem 1.7rem 1.8rem 2.0rem 2.2rem',
        lineheight_formats: '1 1.1 1.2 1.3 1.4 1.5 2',
        urlconverter_callback: function(url, node, on_save, name) { return url; },
        init_instance_callback: function(editor) {
            editor.execCommand('mceFullScreen');
        },
        save_onsavecallback: _SaveEditor,
    });
    function _InitEditor(editor) {
        /* 引入特殊字体支持 */
        setWebStyleSheetLocation(window.productionMode
            ? '../web-incl/app-base.css'
            : '../../../../appxi-swing/repo/web-incl/app-base.css', 'CSS1');

        setWebStyleSheetLocation(javaApp.getWebStyleSheetURI(), 'CSS');

        editor.setContent(javaApp.initEditor());
    }

    function _SaveEditor(editor) {
        javaApp.saveEditor(editor.getContent());
    }

    function onDocumentReady(theme) {
        _InitEditor(tinymce.activeEditor);
    }
    </script>
</head>
<body>
<textarea id="htmlEditor"></textarea>
</body>
</html>